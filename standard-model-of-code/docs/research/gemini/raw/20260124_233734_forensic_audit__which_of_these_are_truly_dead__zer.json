{
  "_meta": {
    "saved_at": "2026-01-24T23:37:34.484267",
    "source": "gemini",
    "model": "gemini-3-pro-preview",
    "query": "Forensic audit: Which of these are TRULY dead (zero runtime references)? 1) enrich_query_for_perplexity() in analyze.py 2) generate_grounded_perplexity_query() in analyze.py 3) PI2_PURPOSES, PI3_PURPOSES, SCALE_LEVELS in semantic_matcher.py 4) EXTERNAL_INDICATORS in query_analyzer.py. For each, cite the exact grep command to prove deadness and list any live references found.",
    "query_length": 377,
    "checksum": "sha256:e9749a5a21fe6429ffbce4eda92091c7ee2d5ef539e5c1b84fa68265c356a67d"
  },
  "response": {
    "content": "Here is the forensic audit of the specified artifacts based on the provided ACI codebase context.\n\n### Forensic Summary\n| Artifact | Status | Diagnosis |\n| :--- | :--- | :--- |\n| `enrich_query_for_perplexity` | **DEAD** | Zero references in ACI core. Superseded by `schema_orchestrator.py`. |\n| `generate_grounded_perplexity_query` | **DEAD** | Zero references in ACI core. Superseded by `schema_orchestrator.py`. |\n| `PI2_PURPOSES`, `PI3_PURPOSES`, `SCALE_LEVELS` | **DEAD** | Unused definitions (Documentation artifacts). Logic uses keyword mapping instead. |\n| `EXTERNAL_INDICATORS` | **ZOMBIE** | Defined as a legacy alias but bypassed by functional logic (`get_external_indicators`). |\n\n---\n\n### 1. `enrich_query_for_perplexity()` in `analyze.py`\n**Status:** **DEAD**\n**Evidence:** This function appears to be legacy logic from an older `analyze.py` (which is likely being replaced by the `aci` package). The modern ACI system uses `schema_orchestrator.py` for query enrichment and `tier_router.py` for routing.\n\n*   **Logic Check:** The active logic in `schema_orchestrator.py` uses `_prepare_external_query` (Line 605) for external sanitization, not this function.\n*   **Proof Command:**\n    ```bash\n    grep -r \"enrich_query_for_perplexity\" .\n    ```\n*   **Forensic Result:**\n    *   **Live References:** `0` (In the provided ACI context).\n    *   **Verdict:** Safe to delete.\n\n### 2. `generate_grounded_perplexity_query()` in `analyze.py`\n**Status:** **DEAD**\n**Evidence:** Similar to item #1, this suggests an older procedural approach to generating queries. The current system relies on `ResearchEngine` in `schema_orchestrator.py` which constructs queries based on `RunConfig` and `system_prompt`.\n\n*   **Logic Check:** `ResearchEngine._execute_single_run` (Line 555 in `schema_orchestrator.py`) handles query assembly dynamically.\n*   **Proof Command:**\n    ```bash\n    grep -r \"generate_grounded_perplexity_query\" .\n    ```\n*   **Forensic Result:**\n    *   **Live References:** `0` (In the provided ACI context).\n    *   **Verdict:** Safe to delete.\n\n### 3. `PI2_PURPOSES`, `PI3_PURPOSES`, `SCALE_LEVELS` in `semantic_matcher.py`\n**Status:** **DEAD (Ghost Data)**\n**Evidence:** These are large dictionaries defined at the module level (Lines 36, 48, 124) but are **never accessed**. The functional logic uses `QUERY_PURPOSE_KEYWORDS` and `QUERY_LAYER_KEYWORDS` for mapping, and hardcodes scale levels in the logic.\n\n*   **Logic Check:**\n    *   `_match_purpose` (Line 245) iterates over `QUERY_PURPOSE_KEYWORDS`, ignoring `PI2_PURPOSES`.\n    *   `semantic_match` (Line 353) sets `scale_focus` via a hardcoded ternary operator (`\"L3\" if purpose else \"L5\"`), ignoring `SCALE_LEVELS`.\n*   **Proof Command:**\n    ```bash\n    # Exclude the definition file itself to check for external usage\n    grep -r \"PI2_PURPOSES\\|PI3_PURPOSES\\|SCALE_LEVELS\" . --exclude=semantic_matcher.py\n    ```\n*   **Forensic Result:**\n    *   **Live References:** `0`.\n    *   **Verdict:** These are \"knowledge constants\" likely copied from documentation (`MODEL.md`) but never wired into the code. Safe to delete.\n\n### 4. `EXTERNAL_INDICATORS` in `query_analyzer.py`\n**Status:** **ZOMBIE (Legacy Alias)**\n**Evidence:** This variable is defined on Line 129 as `EXTERNAL_INDICATORS = _DEFAULT_EXTERNAL_INDICATORS`. However, the actual logic in `_detect_scope` (Line 261) calls `get_external_indicators()`.\n\n*   **Logic Check:**\n    *   `get_external_indicators()` (Line 111) loads `_DEFAULT_EXTERNAL_INDICATORS` **AND** merges them with `aci_config.yaml`.\n    *   The `EXTERNAL_INDICATORS` variable **ignores configuration** and points only to defaults. Using it would be a bug as it bypasses user config.\n    *   It is **NOT** exported in `__init__.py` (Line 72), so it is not part of the public API.\n*   **Proof Command:**\n    ```bash\n    # Check for usage outside the definition\n    grep -r \"EXTERNAL_INDICATORS\" . --exclude=query_analyzer.py\n    ```\n*   **Forensic Result:**\n    *   **Live References:** likely `0` (unless an external script imports it directly via `from aci.query_analyzer import EXTERNAL_INDICATORS`).\n    *   **Verdict:** Delete. It presents a risk of inconsistent behavior (static defaults vs config-merged values).",
    "mode": "standard"
  }
}