{
  "_meta": {
    "saved_at": "2026-01-24T18:25:18.046769",
    "source": "gemini",
    "model": "gemini-3-pro-preview",
    "query": "COMPREHENSIVE SYSTEM MAP of PROJECT_elements.\n\nGenerate a complete inventory of ALL subsystems, modules, and their relationships.\n\nFor EACH subsystem:\n1. NAME and LOCATION (path)\n2. PURPOSE (one sentence)\n3. INPUTS and OUTPUTS\n4. DEPENDENCIES (what it imports/consumes)\n5. STATUS (working, partial, planned, orphaned)\n\nInclude:\n- All tools in context-management/\n- All tools in standard-model-of-code/\n- The .agent/ governance layer\n- Background processes (BARE, AEP, HSL, etc.)\n- Research infrastructure\n- Visualization layer\n\nDraw the COMPLETE system topology. Show data flow arrows.\nIdentify any ORPHANED or DISCONNECTED components.\nRate overall architectural coherence (0-100).",
    "query_length": 681,
    "checksum": "sha256:cb298407f26a7ef639f128950a2b0be88d223fd44c329fd985f25dd7255da5d1"
  },
  "response": {
    "content": "# Comprehensive System Map: PROJECT_elements\n\n**Analysis Date:** 2026-01-24\n**Kernel Version:** 1.5.0\n**Context:** Post-Consolidation, Post-Cutting Plan\n\n---\n\n## 1. System Topology\n\nThe system operates on a \"Particle/Wave\" duality, governed by an \"Observer\" layer.\n\n```mermaid\ngraph TD\n    %% DO NOT RENDER GRAPH, ASCII VERSION BELOW\n```\n\n```\n┌───────────────── GOVERNANCE (The Observer) ─────────────────┐\n│                                                             │\n│  [.agent/KERNEL.md] <──> [.agent/registry/] <──> [.agent/runs/]\n│          │                        ▲                    ▲\n│          │ (Rules)                │ (Tasks)            │ (Logs)\n│          ▼                        ▼                    ▼\n│  ┌───────────────────────────────────────────────────────┐  │\n│  │                AGENTS (Human & AI)                    │  │\n│  └───────────────────────────┬───────────────────────────┘  │\n│                              │                              │\n└──────────────────────────────┼──────────────────────────────┘\n                               │ (Action)\n                               ▼\n┌────────────────── IMPLEMENTATION (The Particle) ──────────────────┐\n│                                                                   │\n│ [standard-model-of-code/]                                         │\n│        │                                                          │\n│        ├─> [Collider Engine] ──> [unified_analysis.json] ──────┐  │\n│        │        (Static Analysis)                              │  │\n│        │                                                       │  │\n│        └─> [Visualization] <───────────────────────────────────┘  │\n│                 (HTML/JS)                                         │\n│                                                                   │\n└──────────────────────────────┬────────────────────────────────────┘\n                               │ (Context)\n                               ▼\n┌────────────────── INTELLIGENCE (The Wave) ────────────────────────┐\n│                                                                   │\n│ [context-management/]                                             │\n│        │                                                          │\n│        ├─> [ACI / analyze.py] <──> [Gemini 2.5/3]                 │\n│        │       │                                                  │\n│        │       └─> [Perplexity MCP] ──> [External Web]            │\n│        │                                                          │\n│        └─> [BARE / Refinery] ──> [.agent/intelligence/atoms/]     │\n│               (Background Refinement)                             │\n│                                                                   │\n└───────────────────────────────────────────────────────────────────┘\n```\n\n---\n\n## 2. Subsystem Inventory\n\n### A. The Observer (Governance & State)\n\n**S0: Kernel & Protocol**\n- **Location:** `.agent/KERNEL.md`, `.agent/manifest.yaml`\n- **Purpose:** Boot protocol, non-negotiable rules, and system configuration.\n- **Inputs:** None (Root of Trust).\n- **Outputs:** Agent behavioral constraints.\n- **Status:** **ACTIVE** (v1.5.0).\n\n**S5: Task Registry (Unified)**\n- **Location:** `.agent/registry/` (`active/`, `inbox/`, `archive/`)\n- **Purpose:** Single Source of Truth (SSOT) for work items and state machine.\n- **Inputs:** `promote_opportunity.py`, `triage_inbox.py`.\n- **Outputs:** `TASK-*.yaml`, `OPP-*.yaml`.\n- **Dependencies:** `task.schema.yaml`, `opportunity.schema.yaml`.\n- **Status:** **ACTIVE** (Consolidated).\n\n**S8: Commit Hygiene**\n- **Location:** `.pre-commit-config.yaml`, `commitlint.config.js`\n- **Purpose:** Enforces conventional commits and code quality before ingestion.\n- **Inputs:** Git commit events.\n- **Outputs:** Pass/Fail signal to Git.\n- **Status:** **ACTIVE**.\n\n### B. The Particle (Implementation & Analysis)\n\n**S1: Collider (The Engine)**\n- **Location:** `standard-model-of-code/src/`\n- **Purpose:** \"Collapses\" code into structured data (Unified Analysis).\n- **Inputs:** Raw Source Code (`.py`, `.js`, etc.).\n- **Outputs:** `unified_analysis.json` (The Ground Truth).\n- **Dependencies:** Tree-sitter, Python AST.\n- **Status:** **ACTIVE** (Refactored into Pipeline architecture).\n\n**S1.1: Survey Module (Adaptive Layer)**\n- **Location:** `standard-model-of-code/src/core/survey.py`\n- **Purpose:** Fast pre-scan to determine exclusion patterns and dataset size.\n- **Inputs:** File system.\n- **Outputs:** `SurveyResult` (CCI metrics).\n- **Status:** **ACTIVE** (Integrated Phase 10).\n\n**S9: Visualization**\n- **Location:** `standard-model-of-code/viz/`\n- **Purpose:** Interactive frontend for the Standard Model of Code.\n- **Inputs:** `unified_analysis.json`.\n- **Outputs:** HTML/D3.js interactive graph.\n- **Status:** **WORKING** (Recent fixes for data toggles).\n\n### C. The Wave (Intelligence & Context)\n\n**S3: ACI Engine (analyze.py)**\n- **Location:** `context-management/tools/ai/analyze.py`\n- **Purpose:** Adaptive Context Intelligence interface; gateway to LLMs.\n- **Inputs:** User query, `analysis_sets.yaml`, `unified_analysis.json`.\n- **Outputs:** Markdown reports, Code suggestions, Research docs.\n- **Dependencies:** Gemini API, HSL Config.\n- **Status:** **ACTIVE** (Rate limiting fixed in TASK-021).\n\n**S2: Holographic Socratic Layer (HSL)**\n- **Location:** `context-management/docs/HOLOGRAPHIC_SOCRATIC_LAYER.md` (Rules) + `analyze.py --verify` (Engine).\n- **Purpose:** Automated semantic validation and drift detection.\n- **Inputs:** `semantic_models.yaml`, Codebase state.\n- **Outputs:** Compliance verdicts (Pass/Fail).\n- **Status:** **ACTIVE** (Daemonized via launchd).\n\n**S4: Perplexity MCP**\n- **Location:** `context-management/tools/mcp/perplexity_mcp_server.py`\n- **Purpose:** External knowledge retrieval and fact-checking.\n- **Inputs:** Research queries.\n- **Outputs:** Cited research markdown.\n- **Status:** **ACTIVE**.\n\n**S6: BARE (Background Auto-Refinement Engine)**\n- **Location:** `.agent/tools/bare` (CLI), `.agent/intelligence/` (Data).\n- **Purpose:** Continuous background refinement of repository knowledge.\n- **Inputs:** Git history, Registry state.\n- **Outputs:** `repo_truths.yaml`, Confidence scores.\n- **Components:**\n    - `TruthValidator`: **ACTIVE**\n    - `ConfidenceBooster`: **ACTIVE**\n    - `Refinery (BARE-Live)`: **FOUNDATION LAID** (Sprint 003).\n- **Status:** **PARTIAL** (Phase 1 operational, Phase 2 in scaffolding).\n\n**S7: Archive & Mirror**\n- **Location:** `context-management/tools/archive/`\n- **Purpose:** Sprawl management and Cloud backup.\n- **Inputs:** Repository state.\n- **Outputs:** GCS Bucket (`gs://elements-archive-2026/`), Local Archive.\n- **Status:** **ACTIVE**.\n\n---\n\n## 3. Data Flow Pathways\n\n### The \"Execution\" Loop\n1.  **Trigger:** Human or BARE creates `OPP-XXX` in Registry (S5).\n2.  **Refinement:** `triage_inbox.py` / `boost_confidence.py` (S6/S3) scores the opportunity.\n3.  **Promotion:** `promote_opportunity.py` converts to `TASK-XXX` (Ready state).\n4.  **Claim:** Agent claims task, creates `RUN-XXX` (S0).\n5.  **Action:** Agent modifies code in `standard-model-of-code/` (S1).\n6.  **Verify:** `pre-commit` (S8) and `analyze.py --verify` (S2) validate changes.\n7.  **Commit:** Changes persist to Git.\n\n### The \"Intelligence\" Loop\n1.  **Scan:** Collider (S1) runs on commit, generating `unified_analysis.json`.\n2.  **Ingest:** BARE (S6) and HSL (S2) read analysis.\n3.  **Detect:** HSL detects drift or violation.\n4.  **Report:** HSL creates new `OPP-XXX` in Registry (S5).\n5.  **Refine:** BARE-Live (Refinery) updates `.agent/intelligence/atoms/`.\n\n---\n\n## 4. Orphans & Disconnected Components\n\n| Component | Location | Status | Diagnosis |\n|-----------|----------|--------|-----------|\n| **Decision Deck** | `.agent/deck/` | **ARCHIVED/WONT_DO** | (TASK-018) \"Spec Theater\". Code exists but marked unused/dead. |\n| **Legacy Registries** | `standard-model-of-code/docs/*/REGISTRY.md` | **READ-ONLY** | Valid historical artifacts, but disconnected from active workflow. |\n| **Testing Suite Doc** | `.agent/workflows/testing_suite.md` | **ARCHIVED** | Moved to `archive/agent_cuts/` via Cutting Plan. |\n| **Old Truths** | `.agent/intelligence/truths/history/` | **ARCHIVED** | Historical snapshots removed to reduce noise. |\n\n---\n\n## 5. Architectural Coherence Rating\n\n**Score: 88/100**\n\n**Strengths:**\n*   **High Symmetry:** The \"Particle/Wave\" split is well-respected in directory structure (`src` vs `context-management`).\n*   **Unified Registry:** Consolidating multiple markdown files into the `.agent/registry` was a critical win.\n*   **Strong Governance:** The Kernel and boot protocol provide clear \"physics\" for the agents.\n\n**Weaknesses (The remaining 12%):**\n*   **BARE-Live Maturity:** The \"Refinery\" (S6 Phase 2) is heavily specified but implementation is just starting (Sprint 003). It is the bridge between static analysis and dynamic context, currently a \"construction zone\".\n*   **Visualization Lag:** The visual layer (S9) often lags behind the Collider's data structure changes (noted in OPP-058/059, though fixed).\n*   **Decision Deck Confusion:** The artifacts exist but the system rejected the premise (TASK-018). These should be fully purged or explicitly marked as \"Museum\" to prevent Agent confusion.\n\n**Conclusion:** The system is robust, self-documenting, and actively self-correcting. The architecture is stable enough to support high-velocity autonomous work.",
    "mode": "standard"
  }
}